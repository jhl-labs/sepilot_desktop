# SEPilot Desktop v0.6.0 릴리스 노트

## 주요 변경 사항

### UI/UX 개선

* **이미지 첨부/생성 시 자동으로 Instant 모드로 전환 및 모드 잠금**
  * 이미지가 붙여넣기되거나 선택되면 자동으로 Thinking 모드가 Instant로 변경됨
  * 이미지 생성 토글이 활성화되면 자동으로 Instant 모드로 전환됨
  * 이미지 생성이 활성화된 동안 Thinking 모드 변경 불가 (두 기능은 공존 불가)
  * 멀티모달 모델과 이미지 생성은 Agent 그래프를 사용해야 하므로 Instant 모드가 최적
  * 사용자 경험 개선: 이미지 분석/생성 시 불필요한 사고 과정 생략

* **LLM 상태 표시줄을 별도 컴포넌트로 분리**
  * InputBox 하단의 모델 정보 표시 부분을 `LLMStatusBar` 컴포넌트로 분리
  * 모델명, max tokens, temperature, 컨텍스트 사용량 표시
  * 클릭하여 max tokens 및 temperature 즉시 수정 가능
  * 코드 재사용성 및 유지보수성 향상

* **사용 가능한 툴 목록 표시 기능**
  * LLMStatusBar에 MCP 툴 개수 표시 (예: "5 tools")
  * 툴 아이콘 클릭 시 Popover로 전체 툴 목록 표시
  * MCP 서버별 그룹화 및 Built-in 툴 구분
  * 각 툴의 이름과 설명 표시로 사용 가능한 기능 확인 용이
  * Radix UI Popover 컴포넌트 추가

### 코딩 에이전트 (Thinking Mode: Coding) 개선

* **Human-in-the-loop 툴 승인 기능 정상 작동**
  * `CodingAgentGraph` 클래스 추가 및 `stream()` 메서드 구현
  * Agent 그래프와 동일한 패턴으로 툴 승인 콜백 통합
  * 툴 호출 시 사용자 승인 대기 및 승인/거부 이벤트 처리
  * `lib/langgraph/index.ts`의 `streamCodingAgentGraph()` 메서드로 스트리밍 처리

* **에이전트 툴 호출 화면 표시 개선**
  * 각 노드 실행 시 이벤트 yield 추가 (`type: 'node'`)
  * Triage, Planner, Agent, Tools, Verifier, Reporter 등 모든 노드의 실행 상태 UI에 표시
  * 툴 승인 요청 및 결과 이벤트 (`tool_approval_request`, `tool_approval_result`) 별도 처리
  * 에러 이벤트 (`type: 'error'`) 처리 강화

* **코드 구조 개선**
  * Agent 그래프 (`agent.ts`)의 구현 패턴을 Coding Agent에 적용
  * 반복 가드 (iteration guard) 로직으로 무한 루프 방지
  * State 업데이트 및 이벤트 방출 로직 일관성 확보

* **Coding Agent 과정 전체 표시 (Claude Code 스타일)**
  * ReAct iteration 중 메시지가 사라지는 문제 해결
  * 모든 thinking, tool call, tool result 과정을 순차적으로 표시
  * 각 단계별 아이콘 및 포맷팅:
    - 🤔 **Thinking**: AI의 사고 과정
    - 🔧 **Using tools**: 사용 중인 툴 목록
    - ✅ **Tool result**: 툴 실행 결과 (500자 초과 시 truncate)
  * 긴 스크롤이 발생해도 전체 과정이 유지되어 사용자가 무슨 일이 일어나는지 명확히 파악 가능

* **Claude Code 스타일로 완전 리팩토링**
  * 복잡한 노드 제거 (Triage, Planner, Verifier)
  * 단순한 ReAct 루프 구현: Agent → Tool Approval → Tools → 반복
  * enhancedToolsNode에서 툴 결과를 메시지로 변환하여 LLM에 전달
    - file_list 등의 툴이 가짜 응답 대신 실제 결과 반환
    - OpenAI 호환 형식으로 tool result 메시지 생성
  * Reporter 노드를 에러/최대 반복 시에만 메시지 생성하도록 수정
    - 정상 완료 시 빈 객체 반환하여 기존 메시지 유지
    - 모든 thinking, tool call, tool result 과정이 화면에 남아있음
  * ToolExecutionResult 타입 명시적 정의로 타입 안정성 확보

### 버그 수정

* **이미지 갤러리/문서 관리 페이지에서 대화 클릭 시 채팅 화면으로 전환되지 않던 문제 해결**
  * Sidebar에 `onConversationClick` prop 추가
  * 대화 목록 및 검색 결과 클릭 시 viewMode를 'chat'으로 전환하도록 수정
  * 이제 갤러리나 문서 페이지에서 사이드바의 대화를 클릭하면 정상적으로 채팅 화면으로 돌아감

* **InputBox 컴포넌트 미사용 변수 제거**
  * `ImageGenerationProgress` 타입 import 제거
  * `updateImageGenerationProgress` 함수 destructure 제거

---

**전체 변경 로그**: v0.5.0...v0.6.0
