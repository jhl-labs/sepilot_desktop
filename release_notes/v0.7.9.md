# SEPilot Desktop v0.7.9 릴리스 노트

**릴리즈 날짜**: 2026-01-07

---

## 🚀 Terminal Extension - 경로 동기화 & ANSI 색상 지원

v0.7.9에서 Terminal Extension의 사용성과 시각적 경험을 대폭 개선했습니다!

---

## 🎯 핵심 신기능

### 1. **터미널 cd 명령어 자동 감지 및 경로 동기화**

**문제:**

- 사용자가 터미널에서 `cd` 명령어로 디렉토리를 변경해도 세션의 cwd가 업데이트되지 않음
- 다른 탭으로 전환 후 돌아오면 이전 경로로 돌아감
- AI 명령어 제안 시 잘못된 경로를 기반으로 동작

**해결:**

- PTY 출력을 실시간으로 분석하여 `cd` 명령어 감지
- 명령어 실행 후 `pwd`를 자동 실행하여 현재 경로 확인
- 세션 store의 cwd 자동 업데이트

**구현:**

```typescript
// pty-manager.ts
ptyProcess.on('data', (data) => {
  const text = data.toString();

  // cd 명령어 감지
  if (text.trim().startsWith('cd ')) {
    // pwd 실행하여 현재 경로 확인
    ptyProcess.write('pwd\n');
  }

  // pwd 출력 파싱
  const cwdMatch = text.match(/^\/[\w\/\-\.]+$/m);
  if (cwdMatch) {
    const newCwd = cwdMatch[0];
    mainWindow.webContents.send('terminal:cwd-changed', {
      sessionId,
      cwd: newCwd,
    });
  }
});
```

**장점:**

- ✅ 터미널과 세션 상태 완벽 동기화
- ✅ AI가 정확한 경로를 기반으로 명령어 제안
- ✅ 사용자 경험 향상

### 2. **터미널 ANSI 제어 문자 처리 및 색상 지원**

**문제:**

- 터미널 출력에 ANSI escape code가 그대로 표시됨
- `\x1b[32m`, `\x1b[0m` 등의 제어 문자가 가독성을 해침
- 색상 정보가 무시되어 단조로운 출력

**해결:**

- ANSI escape code를 HTML로 변환
- 색상, Bold, Italic, Underline 등 스타일 지원
- 깔끔한 터미널 출력 경험

**구현:**

```typescript
// ansi-parser.ts
const ANSI_COLORS = {
  30: '#1e1e1e', // Black
  31: '#cd3131', // Red
  32: '#0dbc79', // Green
  33: '#e5e510', // Yellow
  34: '#2472c8', // Blue
  35: '#bc3fbc', // Magenta
  36: '#11a8cd', // Cyan
  37: '#e5e5e5', // White
};

function parseAnsiToHtml(text: string): string {
  // ANSI 색상 코드를 span 태그로 변환
  return text
    .replace(/\x1b\[(\d+)m/g, (_, code) => {
      const color = ANSI_COLORS[code];
      return color ? `<span style="color: ${color}">` : '';
    })
    .replace(/\x1b\[0m/g, '</span>');
}
```

**지원 기능:**

- ✅ 16가지 기본 색상
- ✅ Bright 색상 (90-97)
- ✅ 배경색
- ✅ Bold, Italic, Underline
- ✅ 커서 이동 제어 문자 제거

**Before:**

```
\x1b[32m✓\x1b[0m Build successful
\x1b[31mError:\x1b[0m File not found
```

**After:**

```
✓ Build successful (초록색)
Error: File not found (빨간색)
```

### 3. **LLM 설정 - 수동 모델 입력 UI 추가**

**문제:**

- 일부 LLM Provider는 `/v1/models` API를 지원하지 않음
- API 미지원 시 모델을 추가할 방법이 없음
- 커스텀 로컬 서버나 비표준 API를 사용하는 경우 불편

**해결:**

- "Add Manually" 버튼 추가
- Connection 선택 + Model ID 수동 입력 폼 제공
- 기존 "Fetch Models" 기능과 병행 사용 가능

**구현:**

```typescript
// ModelListView.tsx
const handleManualAddModel = () => {
  // 1. 유효성 검사 (빈 값, Connection 존재 여부)
  // 2. 중복 검사 (connectionId + modelId 조합)
  // 3. 모델 추가
  const newModel: ModelConfig = {
    id: `model-${nanoid()}`,
    connectionId: manualConnectionId,
    modelId: manualModelId.trim(),
    tags: [],
    temperature: defaultTemperature,
    maxTokens: defaultMaxTokens,
  };
  onModelsChange([...models, newModel]);
};
```

**UI 구성:**

- Connection 선택 (Select 컴포넌트)
- Model ID 입력 (Input 컴포넌트)
- 실시간 유효성 검증 (버튼 비활성화)
- Enter 키로 빠른 추가 지원
- 중복 검사 및 에러 표시 (3초 후 자동 제거)

**장점:**

- ✅ /v1/models API 미지원 Provider 호환
- ✅ 커스텀 모델 ID 직접 입력 가능
- ✅ 기존 기능과 자연스럽게 통합
- ✅ 다국어 지원 (한/영/중)

### 4. **코드 품질 개선**

**테스트 정리:**

- 존재하지 않는 컴포넌트의 테스트 파일 삭제
- 테스트 커버리지 정확도 향상

**워크플로우 개선:**

- Issue 생성 부분의 template literal을 한 줄로 변환
- 모든 워크플로우 template literal 일관성 유지
- 코드 가독성 및 유지보수성 향상

---

## 📦 구현된 기능 요약

### 터미널 경로 동기화 ✅

- ✅ cd 명령어 자동 감지
- ✅ pwd 실행 및 출력 파싱
- ✅ 세션 cwd 자동 업데이트
- ✅ IPC 이벤트 (terminal:cwd-changed)
- ✅ Store 업데이트 핸들러

### ANSI 색상 지원 ✅

- ✅ ANSI escape code 파싱
- ✅ 16가지 기본 색상 + Bright 색상
- ✅ 배경색 지원
- ✅ Bold, Italic, Underline
- ✅ HTML 렌더링 최적화
- ✅ 커서 제어 문자 필터링

### LLM 설정 개선 ✅

- ✅ 수동 모델 입력 UI 추가
- ✅ Connection 선택 + Model ID 입력
- ✅ 중복 검사 및 유효성 검증
- ✅ 다국어 지원 (한/영/중)
- ✅ Enter 키 빠른 입력 지원

### 코드 품질 ✅

- ✅ 테스트 파일 정리
- ✅ Template literal 최적화
- ✅ 타입 안전성 유지

---

## 🔧 주요 파일 구조

```
extensions/terminal/
├── utils/
│   └── ansi-parser.ts            # ANSI → HTML 변환
├── components/
│   └── TerminalBlock.tsx         # HTML 렌더링
electron/
├── services/
│   └── pty-manager.ts            # cd 감지 & pwd 실행
└── preload.ts                    # terminal:cwd-changed 이벤트

components/settings/
└── ModelListView.tsx             # 수동 모델 입력 UI

locales/
├── ko.json                       # 한국어 번역
├── en.json                       # 영어 번역
└── zh.json                       # 중국어 번역
```

---

## 🎯 사용 시나리오

### 시나리오 1: 디렉토리 이동 후 명령어 실행

```
사용자: cd /home/user/project
[터미널]
→ pwd 자동 실행
→ /home/user/project
→ 세션 cwd 업데이트

사용자: "현재 폴더의 파일 목록을 보여줘"
AI: "ls -la" (올바른 경로에서 실행)
```

### 시나리오 2: 색상 있는 빌드 출력

```
사용자: pnpm run build

[터미널 출력 - 색상 적용됨]
✓ Creating an optimized production build (초록색)
✓ Compiled successfully (초록색)
⚠ Warning: Large bundle size (노란색)
✗ Error: Module not found (빨간색)
```

### 시나리오 3: 다중 세션에서 경로 관리

```
[Session 1]
→ cd /project/frontend
→ npm run dev

[Session 2]
→ cd /project/backend
→ npm run dev

각 세션은 독립적인 경로 유지
세션 전환 시에도 경로 보존
```

### 시나리오 4: /v1/models API 미지원 Provider에서 모델 추가

```
사용자: 커스텀 LLM 서버 Connection 추가
→ Name: "Local Ollama"
→ Base URL: "http://localhost:11434"
→ API Key: "none"

사용자: Models 탭 → "Fetch Models" 클릭
→ 에러: API endpoint /v1/models not found

사용자: "Add Manually" 버튼 클릭
[수동 입력 폼]
→ Connection: "Local Ollama" 선택
→ Model ID: "llama3:latest" 입력
→ "Add Model" 클릭

결과: 모델 추가 완료! ✅
→ Display Name, Temperature, MaxTokens 설정 가능
→ base/vision/autocomplete 태그 지정 가능
→ 활성 모델로 설정 가능
```

---

## 🔄 v0.7.8 대비 변경사항

### 추가된 기능

- ✅ 터미널 cd 명령어 자동 감지 및 경로 동기화
- ✅ ANSI 제어 문자 처리 및 색상 지원
- ✅ pwd 자동 실행 및 파싱
- ✅ terminal:cwd-changed IPC 이벤트
- ✅ LLM 설정 - 수동 모델 입력 UI 추가
- ✅ /v1/models API 미지원 Provider 호환

### 개선사항

- ✅ 터미널 출력 가독성 대폭 향상
- ✅ 세션 상태 정확도 개선
- ✅ AI 명령어 제안 정확도 향상
- ✅ 코드 품질 및 테스트 커버리지 개선
- ✅ LLM 모델 추가 유연성 향상

### 버그 수정

- ✅ cd 명령어 후 cwd 미동기화 문제 해결
- ✅ ANSI escape code 표시 문제 해결
- ✅ Template literal 포맷팅 일관성 개선

---

## 📊 성능 및 통계

**구현 파일:**

- 신규 파일: 1개 (ansi-parser.ts)
- 수정 파일: 7개 (ModelListView.tsx, ko.json, en.json, zh.json 등)
- 추가 코드: ~300 lines

**기능 완성도:**

- Phase 1-8: 100% (v0.7.8)
- Phase 9: 100% (v0.7.9 - 경로 동기화 & 색상 지원)
- 전체: ~75% (Warp 대비)

---

## ⚠️ 알려진 제한사항

**pwd 파싱 제한:**

- 복잡한 프롬프트 설정 시 pwd 출력 파싱 실패 가능
- 심볼릭 링크 경로는 실제 경로로 변환됨

**ANSI 지원 범위:**

- 256색 및 True Color는 아직 미지원
- 일부 복잡한 제어 문자 조합 미지원

**향후 계획:**

- ❌ 인터랙티브 명령어 (vim, nano, top 등)
- ❌ 명령어 실행 중 취소 기능
- ❌ 세션 복원 (앱 재시작 후)
- ❌ SSH 원격 세션

---

## 🎉 결론

**v0.7.9는 Terminal Extension을 더욱 실용적이고 시각적으로 만족스럽게 만들었습니다!**

구현된 핵심 개선:

- ✅ 자동 경로 동기화 (cd 명령어 감지)
- ✅ 풀 컬러 터미널 출력 (ANSI 지원)
- ✅ 다중 세션 완벽 지원
- ✅ 실시간 스트리밍 출력
- ✅ AI 명령어 제안 및 실행
- ✅ LLM 수동 모델 입력 (API 미지원 Provider 호환)

**이제 터미널은 Warp처럼 아름답고, 똑똑하며, 실용적입니다!**

**그리고 LLM 설정은 더욱 유연하고 강력해졌습니다!**

다음 단계: 인터랙티브 명령어 지원, 명령어 취소 기능 추가 예정

감사합니다! 🚀
