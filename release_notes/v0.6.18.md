# SEPilot Desktop v0.6.18

릴리즈 날짜: 2024-12-30

## 🎯 주요 변경사항

### 🧪 테스트 인프라 개선

#### E2E 테스트 Headless 환경 지원

- **Xvfb 자동 감지 및 실행**: headless 환경(서버, CI/CD)에서 E2E 테스트 실행 가능
- **스마트 실행 스크립트**: GUI/headless 환경 자동 구분
- **사용자 친화적 오류 메시지**: Xvfb 미설치 시 설치 가이드 제공

**기술 세부사항**:

- `scripts/run-e2e-tests.sh` 추가: Xvfb 확인 및 자동 실행
- `e2e_tests/helpers/app-launcher.ts`: Electron 실행 옵션 개선
  - `--no-sandbox`, `--disable-gpu`, `--disable-dev-shm-usage` 플래그 추가
  - DISPLAY 환경 변수 자동 설정
- `package.json`: E2E 테스트 스크립트를 래퍼로 변경

#### 테스트 안정성 향상

- **React act(...) 경고 수정**: `ToolApprovalDialog` 컴포넌트의 unmount 시 setState 방지
- **i18n mock 추가**: `react-i18next` mock 구현으로 번역 키 테스트 가능
  - 실제 한국어 번역 파일(locales/ko.json) 로드
  - Interpolation 지원 (`{{count}}개` → `2개`)

**테스트 결과**:

- 단위 테스트: DocumentList 테스트 31/32 통과
- E2E 테스트: headless 환경 지원 완료

### 📚 문서화

#### README 업데이트

- **개발 & 테스트 섹션 추가**:
  - 단위 테스트 실행 방법 (frontend/backend 분리)
  - E2E 테스트 실행 방법 (Xvfb 설치 가이드 포함)
  - 영어/한국어 모두 업데이트

## 🐛 버그 수정

### Webpack Node: Protocol 처리

- **문제**: `UnhandledSchemeError: Reading from "node:assert" is not handled by plugins`
- **원인**: 일부 의존성(synckit, log-update 등)이 `node:` protocol을 사용하지만 webpack이 처리하지 못함
- **해결**: `next.config.js`에 webpack resolve.alias 추가
  - `node:assert` → `assert`
  - `node:async_hooks` → `async_hooks`
  - `node:buffer` → `buffer`
  - `node:console` → `console`
  - `node:crypto` → `crypto`
  - 기타 20개 Node.js 내장 모듈 매핑
- **영향**: Windows, macOS, Linux 모든 플랫폼에서 빌드 가능

### 프록시 관련 수정 (v0.6.17)

- undici를 사용하여 프록시 비활성화 시 환경 변수 무시 메커니즘 강화
- 프록시 설정 논리적 모순 방지 및 자동 정규화
- browser-stub에 safeJsonParse 및 HttpError export 추가
- JSON 파싱 에러 처리 개선

## 📦 의존성 업데이트

### 주요 업데이트

- **Next.js**: 16.0.10 → 16.1.1
- **lucide-react**: 0.555.0 → 0.562.0
- **markdown-to-jsx**: 9.3.5 → 9.5.0
- **zod**: 4.1.13 → 4.2.1
- **node-pty**: 1.1.0-beta43 → 1.1.0 (stable)
- **@xterm/addon-fit**: 0.10.0 → 0.11.0
- **@xterm/addon-web-links**: 0.11.0 → 0.12.0
- **@next/bundle-analyzer**: 16.0.10 → 16.1.1
- **eslint-config-next**: 16.1.0 → 16.1.1

### DevDependencies

- eslint group 업데이트 (2개 패키지)

## 🔧 기술 개선

### 테스트 인프라

1. **E2E 테스트 환경 구성**:
   - Electron 바이너리 설치 자동화
   - X server 부재 문제 해결 (Xvfb)
   - 실행 옵션 최적화

2. **단위 테스트**:
   - i18n mock 개선
   - React 컴포넌트 테스트 안정성 향상

### 개발자 경험

- 테스트 실행 가이드 문서화
- 환경별 테스트 실행 방법 제공
- 오류 메시지 및 해결 방법 개선

## 📝 커밋 내역

### 주요 커밋

- `feat: E2E 테스트 headless 환경 지원 및 문서화` (da38536)
- `fix: 테스트 안정성 개선 및 i18n mock 추가` (1fb4f72)
- `fix: undici를 사용하여 프록시 비활성화 시 환경 변수 무시 메커니즘 강화` (72d6a54)

### Dependency 업데이트 (Dependabot)

- 9개의 의존성 업데이트 PR 병합

## 🚀 다음 버전 계획

- E2E 테스트 커버리지 확대
- 추가 단위 테스트 작성
- CI/CD 파이프라인 개선

## 📋 알려진 이슈

- E2E 테스트는 headless 환경에서 Xvfb 설치 필요
- GUI 환경(macOS, Windows, Linux Desktop)에서는 추가 설정 없이 실행 가능

---

**전체 변경사항**: [v0.6.17...v0.6.18](https://github.com/jhl-labs/sepilot_desktop/compare/v0.6.17...v0.6.18)
