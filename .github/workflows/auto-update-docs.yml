name: Auto Update Documentation

on:
  schedule:
    # 1ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰
    - cron: '0 * * * *'
  workflow_dispatch:
    inputs:
      force_update:
        description: 'ê°•ì œ ì—…ë°ì´íŠ¸ (true/false)'
        required: false
        default: 'false'
        type: choice
        options:
          - 'true'
          - 'false'

permissions:
  contents: write
  pull-requests: write

jobs:
  update-docs:
    name: Update docs/dev.html
    runs-on: ubuntu-latest
    timeout-minutes: 20

    steps:
      - name: Checkout repository
        uses: actions/checkout@v6
        with:
          fetch-depth: 50  # ìµœê·¼ 50ê°œ ì»¤ë°‹ ê°€ì ¸ì˜¤ê¸°
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Setup pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10

      - name: Setup Node.js
        uses: actions/setup-node@v6
        with:
          node-version: '20'
          cache: 'pnpm'

      - name: Configure git
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git config --global url."https://github.com/".insteadOf "git@github.com:"

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Analyze recent changes
        id: analyze_changes
        run: |
          echo "## ğŸ“Š ìµœê·¼ ë³€ê²½ì‚¬í•­ ë¶„ì„" > changes-report.md
          echo "" >> changes-report.md

          # ìµœê·¼ 1ì‹œê°„ ë™ì•ˆì˜ ì»¤ë°‹ í™•ì¸
          recent_commits=$(git log --since="1 hour ago" --oneline | wc -l)
          echo "RECENT_COMMITS=$recent_commits" >> $GITHUB_OUTPUT

          if [ "$recent_commits" -eq 0 ] && [ "${{ inputs.force_update }}" != "true" ]; then
            echo "has_changes=false" >> $GITHUB_OUTPUT
            echo "â„¹ï¸ ìµœê·¼ 1ì‹œê°„ ë™ì•ˆ ë³€ê²½ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤." >> changes-report.md
            exit 0
          fi

          echo "has_changes=true" >> $GITHUB_OUTPUT
          echo "ğŸ“ ìµœê·¼ 1ì‹œê°„ ë™ì•ˆ ${recent_commits}ê°œì˜ ì»¤ë°‹ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤." >> changes-report.md
          echo "" >> changes-report.md

          # ìµœê·¼ ì»¤ë°‹ ëª©ë¡
          echo "### ìµœê·¼ ì»¤ë°‹ ëª©ë¡" >> changes-report.md
          git log --since="1 hour ago" --pretty=format:"- %h %s (%an)" >> changes-report.md
          echo "" >> changes-report.md
          echo "" >> changes-report.md

          # ë³€ê²½ëœ íŒŒì¼ ë¶„ì„
          echo "### ë³€ê²½ëœ íŒŒì¼" >> changes-report.md
          git diff --name-only HEAD~${recent_commits}..HEAD | sort -u > changed-files.txt
          cat changed-files.txt >> changes-report.md
          echo "" >> changes-report.md

          # ì£¼ìš” ì˜ì—­ë³„ ë³€ê²½ì‚¬í•­
          echo "### ì£¼ìš” ì˜ì—­ë³„ ë³€ê²½ì‚¬í•­" >> changes-report.md

          architecture_changes=$(grep -E "^(app/|components/|electron/|lib/)" changed-files.txt | wc -l)
          extension_changes=$(grep -E "^extensions/" changed-files.txt | wc -l)
          config_changes=$(grep -E "^(package.json|tsconfig|next.config)" changed-files.txt | wc -l)

          echo "- ì•„í‚¤í…ì²˜ ë³€ê²½: ${architecture_changes}ê°œ íŒŒì¼" >> changes-report.md
          echo "- Extension ë³€ê²½: ${extension_changes}ê°œ íŒŒì¼" >> changes-report.md
          echo "- ì„¤ì • ë³€ê²½: ${config_changes}ê°œ íŒŒì¼" >> changes-report.md

          echo "ARCH_CHANGES=$architecture_changes" >> $GITHUB_OUTPUT
          echo "EXT_CHANGES=$extension_changes" >> $GITHUB_OUTPUT
          echo "CONFIG_CHANGES=$config_changes" >> $GITHUB_OUTPUT

      - name: Generate project structure snapshot
        if: steps.analyze_changes.outputs.has_changes == 'true'
        run: |
          echo "## ğŸ“ í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡°" > project-snapshot.md
          echo "" >> project-snapshot.md

          # ë””ë ‰í† ë¦¬ êµ¬ì¡°
          echo "### ë””ë ‰í† ë¦¬ êµ¬ì¡° (ì£¼ìš” ë””ë ‰í† ë¦¬)" >> project-snapshot.md
          echo "\`\`\`" >> project-snapshot.md
          tree -L 2 -d -I 'node_modules|.next|dist|out|coverage' . >> project-snapshot.md || find . -type d -maxdepth 2 ! -path "*/node_modules/*" ! -path "*/.next/*" ! -path "*/dist/*" ! -path "*/out/*" -print | head -50 >> project-snapshot.md
          echo "\`\`\`" >> project-snapshot.md
          echo "" >> project-snapshot.md

          # package.jsonì—ì„œ ì£¼ìš” ì •ë³´ ì¶”ì¶œ
          echo "### ê¸°ìˆ  ìŠ¤íƒ" >> project-snapshot.md
          echo "\`\`\`json" >> project-snapshot.md
          jq '{
            name,
            version,
            dependencies: .dependencies | with_entries(select(.key | test("^(react|next|electron|@langchain)"; "i"))),
            devDependencies: .devDependencies | with_entries(select(.key | test("^(typescript|@types|eslint)"; "i")))
          }' package.json >> project-snapshot.md
          echo "\`\`\`" >> project-snapshot.md
          echo "" >> project-snapshot.md

          # Extensions ëª©ë¡
          echo "### Extensions" >> project-snapshot.md
          if [ -d "extensions" ]; then
            ls -d extensions/*/ | sed 's|extensions/||;s|/$||' | sed 's/^/- /' >> project-snapshot.md
          fi
          echo "" >> project-snapshot.md

          # IPC handlers ëª©ë¡
          echo "### IPC Handlers" >> project-snapshot.md
          if [ -d "electron/ipc/handlers" ]; then
            ls electron/ipc/handlers/*.ts 2>/dev/null | xargs -n1 basename | sed 's/\.ts$//' | sed 's/^/- /' >> project-snapshot.md
          fi

      - name: Update docs with Claude
        if: steps.analyze_changes.outputs.has_changes == 'true'
        id: claude_update
        uses: anthropics/claude-code-action@v1
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          prompt: |
            # docs/dev.html ìë™ ì—…ë°ì´íŠ¸ ë¯¸ì…˜

            ## ëª©í‘œ
            í”„ë¡œì íŠ¸ì˜ ìµœê·¼ ë³€ê²½ì‚¬í•­ì„ ë¶„ì„í•˜ì—¬ docs/dev.html ë¬¸ì„œë¥¼ ìµœì‹  ìƒíƒœë¡œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.

            ## ë³€ê²½ì‚¬í•­ ìš”ì•½
            - ìµœê·¼ ì»¤ë°‹ ìˆ˜: ${{ steps.analyze_changes.outputs.RECENT_COMMITS }}ê°œ
            - ì•„í‚¤í…ì²˜ ë³€ê²½: ${{ steps.analyze_changes.outputs.ARCH_CHANGES }}ê°œ íŒŒì¼
            - Extension ë³€ê²½: ${{ steps.analyze_changes.outputs.EXT_CHANGES }}ê°œ íŒŒì¼
            - ì„¤ì • ë³€ê²½: ${{ steps.analyze_changes.outputs.CONFIG_CHANGES }}ê°œ íŒŒì¼

            ## ë¶„ì„í•  íŒŒì¼
            1. changes-report.md - ìµœê·¼ ë³€ê²½ì‚¬í•­ ìƒì„¸ ë‚´ì—­
            2. project-snapshot.md - í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡° ìŠ¤ëƒ…ìƒ·
            3. docs/dev.html - ì—…ë°ì´íŠ¸í•  ë¬¸ì„œ (í˜„ì¬ ë²„ì „)

            ## ì—…ë°ì´íŠ¸ ì§€ì¹¨

            ### 1. ë³€ê²½ì‚¬í•­ ë¶„ì„
            - changes-report.mdë¥¼ ì½ê³  ì–´ë–¤ ë³€ê²½ì´ ìˆì—ˆëŠ”ì§€ íŒŒì•…
            - ë³€ê²½ëœ íŒŒì¼ë“¤ì„ ì‹¤ì œë¡œ ì½ì–´ë³´ê³  ë‚´ìš© í™•ì¸
            - ì•„í‚¤í…ì²˜ì— ì˜í–¥ì„ ì£¼ëŠ” ë³€ê²½ì¸ì§€ íŒë‹¨

            ### 2. ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•œ ì„¹ì…˜ ì‹ë³„
            docs/dev.htmlì˜ ë‹¤ìŒ ì„¹ì…˜ë“¤ì„ ê²€í† :
            - **1. ì „ì²´ ì•„í‚¤í…ì²˜** - ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë‚˜ ë ˆì´ì–´ ì¶”ê°€/ë³€ê²½
            - **2. ë””ë ‰í† ë¦¬ êµ¬ì¡°** - ìƒˆë¡œìš´ ë””ë ‰í† ë¦¬ë‚˜ íŒŒì¼ êµ¬ì¡° ë³€ê²½
            - **3. IPC í†µì‹ ** - ìƒˆë¡œìš´ IPC í•¸ë“¤ëŸ¬ ì¶”ê°€/ë³€ê²½
            - **4. ë°ì´í„° íë¦„** - ë°ì´í„° í”Œë¡œìš° ë³€ê²½
            - **5. Extension ì‹œìŠ¤í…œ** - ìƒˆ Extension ì¶”ê°€/ì œê±°
            - **6. LangGraph Agent** - Agent êµ¬ì¡° ë³€ê²½
            - **7. MCP í†µí•©** - MCP ë„êµ¬ ì¶”ê°€/ë³€ê²½
            - **8. ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ** - ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ë³€ê²½
            - **9. ë¹Œë“œ & ë°°í¬** - ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ ë³€ê²½

            ### 3. Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì—…ë°ì´íŠ¸
            **ì¤‘ìš”:** êµ¬ì¡°ê°€ ë³€ê²½ë˜ì—ˆë‹¤ë©´ í•´ë‹¹ Mermaid ë‹¤ì´ì–´ê·¸ë¨ì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”:
            - ìƒˆë¡œìš´ ë…¸ë“œ ì¶”ê°€
            - ì œê±°ëœ ë…¸ë“œ ì‚­ì œ
            - ì—°ê²° ê´€ê³„ ì—…ë°ì´íŠ¸
            - ìŠ¤íƒ€ì¼ ì¼ê´€ì„± ìœ ì§€

            ### 4. í…ìŠ¤íŠ¸ ì„¤ëª… ì—…ë°ì´íŠ¸
            - ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ë‚˜ ì»´í¬ë„ŒíŠ¸ ì„¤ëª… ì¶”ê°€
            - ë³€ê²½ëœ ë™ì‘ ë°©ì‹ ì—…ë°ì´íŠ¸
            - ì˜ˆì‹œ ì½”ë“œ ì—…ë°ì´íŠ¸ (í•„ìš”ì‹œ)
            - ë²„ì „ ì •ë³´ ì—…ë°ì´íŠ¸ (headerì˜ badge)

            ### 5. ì—…ë°ì´íŠ¸ ì›ì¹™
            - âœ… **ì •í™•ì„±**: ì‹¤ì œ ì½”ë“œì™€ ì¼ì¹˜í•˜ëŠ” ë‚´ìš©ë§Œ ì‘ì„±
            - âœ… **ì¼ê´€ì„±**: ê¸°ì¡´ ë¬¸ì„œ ìŠ¤íƒ€ì¼ ìœ ì§€
            - âœ… **ê°„ê²°ì„±**: í•µì‹¬ ë‚´ìš©ë§Œ í¬í•¨
            - âœ… **ì‹œê°ì„±**: Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì ê·¹ í™œìš©
            - âŒ **ì¶”ì¸¡ ê¸ˆì§€**: í™•ì¸ë˜ì§€ ì•Šì€ ë‚´ìš©ì€ ì¶”ê°€í•˜ì§€ ì•ŠìŒ

            ### 6. ë³€ê²½ ê¸°ë¡ ì‘ì„±
            ì—…ë°ì´íŠ¸ ì™„ë£Œ í›„ docs-update-log.md íŒŒì¼ì„ ìƒì„±:

            ```markdown
            # ğŸ“ ë¬¸ì„œ ì—…ë°ì´íŠ¸ ë¡œê·¸

            **ì—…ë°ì´íŠ¸ ì¼ì‹œ:** [í˜„ì¬ ì‹œê°]
            **ì»¤ë°‹ ë¶„ì„ ê¸°ê°„:** ìµœê·¼ 1ì‹œê°„

            ## ğŸ“Š ë³€ê²½ ìš”ì•½

            - ì—…ë°ì´íŠ¸ëœ ì„¹ì…˜: [ì„¹ì…˜ ëª©ë¡]
            - ì¶”ê°€ëœ ë‹¤ì´ì–´ê·¸ë¨: [ê°œìˆ˜]
            - ìˆ˜ì •ëœ ë‹¤ì´ì–´ê·¸ë¨: [ê°œìˆ˜]
            - ì¶”ê°€ëœ ì„¤ëª…: [ë‚´ìš©]

            ## ğŸ” ì£¼ìš” ë³€ê²½ì‚¬í•­

            1. [ë³€ê²½ì‚¬í•­ 1]
               - ì´ìœ : [ì™œ ì—…ë°ì´íŠ¸í–ˆëŠ”ì§€]
               - ë‚´ìš©: [ë¬´ì—‡ì„ ì—…ë°ì´íŠ¸í–ˆëŠ”ì§€]

            2. [ë³€ê²½ì‚¬í•­ 2]
               ...

            ## âš ï¸ ì¶”ê°€ ê²€í†  í•„ìš”

            [ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ì—†ì—ˆë˜ ë‚´ìš©ì´ë‚˜ í™•ì¸ì´ í•„ìš”í•œ ë¶€ë¶„]
            ```

            ## ì‹¤í–‰ ìˆœì„œ

            1. changes-report.md ì½ê¸°
            2. project-snapshot.md ì½ê¸°
            3. ë³€ê²½ëœ íŒŒì¼ë“¤ ì§ì ‘ ì½ì–´ë³´ê¸° (ì¤‘ìš”í•œ íŒŒì¼ë“¤)
            4. docs/dev.html ì½ê¸°
            5. ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•œ ë¶€ë¶„ ì‹ë³„
            6. docs/dev.html ì—…ë°ì´íŠ¸ (Edit tool ì‚¬ìš©)
            7. docs-update-log.md ì‘ì„± (Write tool ì‚¬ìš©)

            **ë³´ìˆ˜ì ìœ¼ë¡œ ì‘ì—…í•˜ì„¸ìš”.** í™•ì‹¤í•˜ì§€ ì•Šì€ ë³€ê²½ì€ docs-update-log.mdì— "ì¶”ê°€ ê²€í†  í•„ìš”"ë¡œ ê¸°ë¡í•˜ê³  ì—…ë°ì´íŠ¸í•˜ì§€ ë§ˆì„¸ìš”.

          claude_args: '--allowed-tools "Read:*,Edit:docs/dev.html,Write:docs-update-log.md,Grep:*,Glob:*"'

      - name: Check if docs were updated
        if: steps.claude_update.conclusion != 'skipped'
        id: check_updates
        run: |
          if [[ -n $(git diff docs/dev.html) ]]; then
            echo "has_updates=true" >> $GITHUB_OUTPUT
            echo "âœ… docs/dev.htmlì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤" > update-summary.md
            echo "" >> update-summary.md
            echo "## ë³€ê²½ ì‚¬í•­:" >> update-summary.md
            git diff --stat docs/dev.html >> update-summary.md
          else
            echo "has_updates=false" >> $GITHUB_OUTPUT
            echo "â„¹ï¸ ì—…ë°ì´íŠ¸í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤." > update-summary.md
          fi

      - name: Create update branch and commit
        if: steps.check_updates.outputs.has_updates == 'true'
        id: create_branch
        env:
          RECENT_COMMITS: ${{ steps.analyze_changes.outputs.RECENT_COMMITS }}
        run: |
          # ë¸Œëœì¹˜ ì´ë¦„ ìƒì„±
          BRANCH_NAME="auto-docs-update/$(date +%Y%m%d-%H%M)"
          echo "branch_name=$BRANCH_NAME" >> $GITHUB_OUTPUT

          # ìƒˆ ë¸Œëœì¹˜ ìƒì„± ë° ì²´í¬ì•„ì›ƒ
          git checkout -b "$BRANCH_NAME"

          # ë³€ê²½ì‚¬í•­ ì»¤ë°‹
          cat > /tmp/commit_msg.txt << 'COMMIT_MSG'
          docs: ê°œë°œì ë¬¸ì„œ ìë™ ì—…ë°ì´íŠ¸

          ìµœê·¼ ì½”ë“œ ë³€ê²½ì‚¬í•­ì„ ë°˜ì˜í•˜ì—¬ docs/dev.htmlì„ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.

          - ë¶„ì„ ê¸°ê°„: ìµœê·¼ 1ì‹œê°„
          COMMIT_MSG
          echo "- ë³€ê²½ ì»¤ë°‹: ${RECENT_COMMITS}ê°œ" >> /tmp/commit_msg.txt
          echo "- ì—…ë°ì´íŠ¸ ë¡œê·¸: docs-update-log.md ì°¸ì¡°" >> /tmp/commit_msg.txt
          echo "" >> /tmp/commit_msg.txt
          echo "ğŸ¤– ìë™ ìƒì„±ëœ ì»¤ë°‹ì…ë‹ˆë‹¤." >> /tmp/commit_msg.txt
          echo "" >> /tmp/commit_msg.txt
          echo "[skip ci]" >> /tmp/commit_msg.txt

          git add docs/dev.html docs-update-log.md
          git commit -F /tmp/commit_msg.txt || echo "No changes to commit"

          # í‘¸ì‹œ
          git push origin "$BRANCH_NAME"

      - name: Create Pull Request
        if: steps.check_updates.outputs.has_updates == 'true'
        uses: actions/github-script@v8
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const fs = require('fs');
            const branchName = '${{ steps.create_branch.outputs.branch_name }}';

            let changesReport = '';
            if (fs.existsSync('changes-report.md')) {
              changesReport = fs.readFileSync('changes-report.md', 'utf8');
            }

            let updateLog = '';
            if (fs.existsSync('docs-update-log.md')) {
              updateLog = fs.readFileSync('docs-update-log.md', 'utf8');
            }

            const recentCommits = '${{ steps.analyze_changes.outputs.RECENT_COMMITS }}';

            const title = `ğŸ“š ë¬¸ì„œ ìë™ ì—…ë°ì´íŠ¸ (${recentCommits}ê°œ ì»¤ë°‹ ë°˜ì˜)`;

            const body = `# ğŸ“š ê°œë°œì ë¬¸ì„œ ìë™ ì—…ë°ì´íŠ¸

**ì‹¤í–‰ ì¼ì‹œ:** ${new Date().toISOString()}
**ì›Œí¬í”Œë¡œìš°:** [Run #${{ github.run_id }}](../actions/runs/${{ github.run_id }})

## ğŸ“Š ì—…ë°ì´íŠ¸ ìš”ì•½

- ë¶„ì„ ê¸°ê°„: ìµœê·¼ 1ì‹œê°„
- ë³€ê²½ ì»¤ë°‹: ${recentCommits}ê°œ
- ì—…ë°ì´íŠ¸ íŒŒì¼: docs/dev.html

---

## ğŸ“ ì—…ë°ì´íŠ¸ ë¡œê·¸

${updateLog || 'ì—…ë°ì´íŠ¸ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'}

---

## ğŸ” ë¶„ì„ëœ ë³€ê²½ì‚¬í•­

<details>
<summary>í¼ì³ë³´ê¸°</summary>

${changesReport}

</details>

---

## âš ï¸ ë¦¬ë·° ì•ˆë‚´

ì´ PRì€ **AIê°€ ìë™ìœ¼ë¡œ ìƒì„±**í•œ ë¬¸ì„œ ì—…ë°ì´íŠ¸ì…ë‹ˆë‹¤.

### ë¦¬ë·° ì‹œ í™•ì¸ì‚¬í•­:

1. âœ… **ì •í™•ì„±**: ë¬¸ì„œ ë‚´ìš©ì´ ì‹¤ì œ ì½”ë“œì™€ ì¼ì¹˜í•˜ëŠ”ê°€?
2. âœ… **Mermaid ë‹¤ì´ì–´ê·¸ë¨**: ë‹¤ì´ì–´ê·¸ë¨ì´ ì˜¬ë°”ë¥´ê²Œ ë Œë”ë§ë˜ëŠ”ê°€?
3. âœ… **ì¼ê´€ì„±**: ê¸°ì¡´ ë¬¸ì„œ ìŠ¤íƒ€ì¼ê³¼ ì¼ê´€ë˜ëŠ”ê°€?
4. âœ… **ì™„ì „ì„±**: ì¤‘ìš”í•œ ë³€ê²½ì‚¬í•­ì´ ëˆ„ë½ë˜ì§€ ì•Šì•˜ëŠ”ê°€?

### ê¶Œì¥ ì¡°ì¹˜:

- ğŸŒ docs/dev.htmlì„ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ì–´ í™•ì¸
- ğŸ“Š Mermaid ë‹¤ì´ì–´ê·¸ë¨ ë Œë”ë§ í™•ì¸
- ğŸ“ ì„¤ëª…ì´ ëª…í™•í•˜ê³  ì •í™•í•œì§€ ê²€í† 
- âŒ ë¬¸ì œê°€ ìˆìœ¼ë©´ ê±°ë¶€í•˜ê³  ìˆ˜ë™ ìˆ˜ì •

**AI ìƒì„± ë¬¸ì„œì´ë¯€ë¡œ ë°˜ë“œì‹œ ë¦¬ë·° í›„ ë¨¸ì§€í•˜ì„¸ìš”!**
`;

            const pr = await github.rest.pulls.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: title,
              head: branchName,
              base: 'main',
              body: body
            });

            console.log(`Created PR #${pr.data.number}: ${pr.data.html_url}`);

            // ë¼ë²¨ ì¶”ê°€
            await github.rest.issues.addLabels({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: pr.data.number,
              labels: ['documentation', 'automated', 'ai-generated']
            });

      - name: Upload reports
        if: always()
        uses: actions/upload-artifact@v6
        with:
          name: docs-update-reports
          path: |
            changes-report.md
            project-snapshot.md
            docs-update-log.md
            update-summary.md
          retention-days: 30

      - name: Generate workflow summary
        if: always()
        run: |
          echo "## ğŸ“š ë¬¸ì„œ ìë™ ì—…ë°ì´íŠ¸ ì™„ë£Œ" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          if [ "${{ steps.analyze_changes.outputs.has_changes }}" == "true" ]; then
            echo "### ğŸ“Š ë¶„ì„ ê²°ê³¼" >> $GITHUB_STEP_SUMMARY
            echo "- ìµœê·¼ ì»¤ë°‹: ${{ steps.analyze_changes.outputs.RECENT_COMMITS }}ê°œ" >> $GITHUB_STEP_SUMMARY
            echo "- ì•„í‚¤í…ì²˜ ë³€ê²½: ${{ steps.analyze_changes.outputs.ARCH_CHANGES }}ê°œ íŒŒì¼" >> $GITHUB_STEP_SUMMARY
            echo "- Extension ë³€ê²½: ${{ steps.analyze_changes.outputs.EXT_CHANGES }}ê°œ íŒŒì¼" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY

            if [ "${{ steps.check_updates.outputs.has_updates }}" == "true" ]; then
              echo "### ğŸ“ ì—…ë°ì´íŠ¸ ì™„ë£Œ" >> $GITHUB_STEP_SUMMARY
              echo "âœ… docs/dev.htmlì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!" >> $GITHUB_STEP_SUMMARY
              echo "ğŸ“‹ PRì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ë¦¬ë·° í›„ ë¨¸ì§€í•´ì£¼ì„¸ìš”." >> $GITHUB_STEP_SUMMARY
            else
              echo "### â„¹ï¸ ì—…ë°ì´íŠ¸ ë¶ˆí•„ìš”" >> $GITHUB_STEP_SUMMARY
              echo "ë³€ê²½ì‚¬í•­ì´ ë¬¸ì„œì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤." >> $GITHUB_STEP_SUMMARY
            fi
          else
            echo "### â„¹ï¸ ë³€ê²½ì‚¬í•­ ì—†ìŒ" >> $GITHUB_STEP_SUMMARY
            echo "ìµœê·¼ 1ì‹œê°„ ë™ì•ˆ ì»¤ë°‹ì´ ì—†ìŠµë‹ˆë‹¤." >> $GITHUB_STEP_SUMMARY
          fi

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ğŸ“ ì•„í‹°íŒ©íŠ¸" >> $GITHUB_STEP_SUMMARY
          echo "ìƒì„¸ ë¦¬í¬íŠ¸ëŠ” [Artifacts](../actions/runs/${{ github.run_id }})ì—ì„œ í™•ì¸í•˜ì„¸ìš”." >> $GITHUB_STEP_SUMMARY
