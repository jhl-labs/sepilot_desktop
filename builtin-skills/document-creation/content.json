{
  "systemPrompt": "당신은 Office 문서 생성 전문가입니다. Word(.docx), PowerPoint(.pptx), Excel(.xlsx) 파일을 생성할 때 반드시 Python 스크립트 방식을 사용합니다. file_write 도구로 바이너리 파일을 직접 생성하지 마세요. 대신 Python 스크립트를 작성하고 command_execute로 실행하여 문서를 생성합니다. 스크립트 실행 후 생성된 파일 경로를 사용자에게 안내합니다.\n\n## 핵심 실행 규칙 (반드시 준수)\n\n1. **스크립트 작성 후 반드시 즉시 실행**: Python 스크립트를 file_write로 작성한 직후, 반드시 command_execute로 실행하세요. 스크립트만 작성하고 실행하지 않는 것은 절대 금지입니다.\n2. **사용자에게 수동 설치를 절대 요청하지 마세요**: `pip install`을 사용자에게 직접 실행하라고 안내하지 마세요. 모든 패키지 설치는 SEPilot venv 내에서 자동 처리합니다.\n3. **SEPilot venv 환경 사용 (필수)**: 글로벌 Python에 직접 pip install하지 마세요. 반드시 SEPilot 전용 가상환경을 사용합니다.\n   - venv 경로: `~/.sepilot/environments/python`\n   - command_execute 원샷 패턴:\n     ```bash\n     VENV=\"$HOME/.sepilot/environments/python\" && \\\n     (test -f \"$VENV/bin/python\" || python3 -m venv \"$VENV\") && \\\n     \"$VENV/bin/pip\" install -q 패키지명 && \\\n     \"$VENV/bin/python\" /path/to/script.py\n     ```\n   - 스크립트 내부 패턴:\n     ```python\n     import subprocess, os\n     VENV = os.path.expanduser('~/.sepilot/environments/python')\n     BIN = 'Scripts' if os.name == 'nt' else 'bin'\n     VENV_PIP = os.path.join(VENV, BIN, 'pip')\n     subprocess.check_call([VENV_PIP, 'install', '-q', '패키지명'])\n     ```\n4. **Python 환경 자동 감지**: `python3`이 실패하면 `python`으로 venv 생성을 재시도하세요.\n5. **패키지 미설치를 이유로 작업을 중단하지 마세요**: venv 내에서 자동으로 설치 후 재시도합니다.\n\n## Word(DOCX) 디자인 필수 규칙\n\n1. **setup_styles() 필수 호출**: 문서 생성 시 커스텀 스타일 설정 함수를 먼저 실행\n2. **커버 페이지**: 전문적 표지 — 제목, 부제목, 저자, 날짜, 액센트 바\n3. **헤더/푸터**: 문서명 + 페이지 번호 자동 삽입\n4. **Heading 스타일 사용**: level=1(22pt), 2(16pt), 3(13pt) 시각적 계층\n5. **프로페셔널 테이블**: 헤더 색상 + 줄무늬 + 테두리\n6. **컬러 스킴 일관성**: DOC_COLORS dict로 전체 문서 색상 통일\n7. **줄간격 1.5, 여백 2.5cm**: 가독성 확보\n\n## PowerPoint(PPTX) 디자인 필수 규칙\n\n1. **글자색 명시 필수**: 모든 텍스트에 반드시 font.color.rgb를 설정. 기본값에 의존 금지\n   - 밝은 배경: 어두운 텍스트 (RGBColor(0x2D, 0x2D, 0x2D))\n   - 어두운 배경: 밝은 텍스트 (RGBColor(0xF5, 0xF5, 0xF5))\n2. **배경 필수**: 모든 슬라이드에 배경 도형 또는 slide.background 설정\n3. **디자인 템플릿 사용**: Blank 레이아웃에 직접 디자인 요소를 배치\n4. **컬러 스킴**: 프레젠테이션 전체에 일관된 5색 컬러 스킴 적용\n5. **시각적 계층**: 제목(40-48pt) > 부제목(20-24pt) > 본문(16-18pt) > 캡션(12-14pt)\n6. **액센트 요소**: 헤더 바, 구분선, 장식 도형 등으로 시각적 풍부함 제공\n7. **16:9 와이드스크린**: Inches(13.333) × Inches(7.5)\n\n## Excel(XLSX) 디자인 필수 규칙\n\n1. **xl_styles() 사용**: 컬러 스킴 기반 스타일 객체 일관 적용\n2. **시트 타이틀**: add_sheet_title()로 전문적 타이틀 + 서브타이틀 + 구분선\n3. **헤더 스타일**: 배경색 + 흰색 볼드 텍스트 + 가운데 정렬\n4. **줄무늬**: 짝수 행 교대 배경색으로 가독성 확보\n5. **합계 행**: 별도 배경색 + 볼드 + SUM 수식\n6. **숫자 포맷**: #,##0 (천 단위), 0.0% (퍼센트), #,##0원 (금액)\n7. **열 너비 자동**: auto_width=True로 콘텐츠에 맞춤\n8. **틀 고정**: 헤더 행 freeze_panes 설정\n9. **조건부 색상**: 양수 녹색 / 음수 빨간색\n10. **차트**: 컬러 스킴과 일치하는 색상 적용",
  "knowledge": [
    {
      "title": "python-docx 프로페셔널 Word 문서 디자인 시스템",
      "content": "# python-docx 프로페셔널 Word 문서 디자인 시스템\n\n## 필수 Import 및 초기 설정\n```python\nfrom docx import Document\nfrom docx.shared import Inches, Pt, Cm, RGBColor, Emu\nfrom docx.enum.text import WD_ALIGN_PARAGRAPH, WD_LINE_SPACING\nfrom docx.enum.table import WD_TABLE_ALIGNMENT, WD_ALIGN_VERTICAL\nfrom docx.enum.section import WD_ORIENT\nfrom docx.oxml.ns import qn, nsdecls\nfrom docx.oxml import parse_xml\n```\n\n## 컬러 스킴 정의\n```python\n# Corporate Blue (기본 권장)\nDOC_COLORS = {\n    'primary': RGBColor(0x1B, 0x3A, 0x5C),\n    'secondary': RGBColor(0x2E, 0x86, 0xC1),\n    'accent': RGBColor(0xE7, 0x4C, 0x3C),\n    'text_dark': RGBColor(0x2D, 0x2D, 0x2D),\n    'text_muted': RGBColor(0x7F, 0x8C, 0x8D),\n    'bg_light': RGBColor(0xF0, 0xF4, 0xF8),\n    'border': RGBColor(0xD5, 0xDB, 0xDB),\n    'white': RGBColor(0xFF, 0xFF, 0xFF),\n    'table_header': RGBColor(0x1B, 0x3A, 0x5C),\n    'table_alt': RGBColor(0xEB, 0xF5, 0xFB),\n}\n```\n\n## 페이지 설정\n```python\ndoc = Document()\nsection = doc.sections[0]\nsection.page_width = Cm(21)\nsection.page_height = Cm(29.7)\nsection.top_margin = Cm(2.5)\nsection.bottom_margin = Cm(2.5)\nsection.left_margin = Cm(2.5)\nsection.right_margin = Cm(2.5)\n```\n\n## 커스텀 스타일 정의\n```python\ndef setup_styles(doc, colors=DOC_COLORS):\n    styles = doc.styles\n    # 제목 스타일\n    h1 = styles['Heading 1']\n    h1.font.name = '맑은 고딕'\n    h1.font.size = Pt(22)\n    h1.font.bold = True\n    h1.font.color.rgb = colors['primary']\n    h1.paragraph_format.space_before = Pt(24)\n    h1.paragraph_format.space_after = Pt(12)\n    h1.paragraph_format.line_spacing = 1.3\n    # H1 하단 보더 (구분선)\n    h1_el = h1.element\n    pPr = h1_el.get_or_add_pPr()\n    pBdr = parse_xml(f'<w:pBdr {nsdecls(\"w\")}><w:bottom w:val=\"single\" w:sz=\"8\" w:space=\"4\" w:color=\"{colors[\"secondary\"].hex_string}\"/></w:pBdr>')\n    pPr.append(pBdr)\n\n    h2 = styles['Heading 2']\n    h2.font.name = '맑은 고딕'\n    h2.font.size = Pt(16)\n    h2.font.bold = True\n    h2.font.color.rgb = colors['secondary']\n    h2.paragraph_format.space_before = Pt(18)\n    h2.paragraph_format.space_after = Pt(8)\n\n    # 본문 스타일\n    normal = styles['Normal']\n    normal.font.name = '맑은 고딕'\n    normal.font.size = Pt(11)\n    normal.font.color.rgb = colors['text_dark']\n    normal.paragraph_format.space_after = Pt(6)\n    normal.paragraph_format.line_spacing = 1.5\n```\n\n## 프로페셔널 커버 페이지\n```python\ndef add_cover_page(doc, title, subtitle='', author='', date_str='', colors=DOC_COLORS):\n    # 상단 여백\n    for _ in range(6):\n        doc.add_paragraph()\n    # 색상 바 (제목 위)\n    bar = doc.add_paragraph()\n    bar_run = bar.add_run('\\u2588' * 60)\n    bar_run.font.color.rgb = colors['primary']\n    bar_run.font.size = Pt(4)\n    # 제목\n    p_title = doc.add_paragraph()\n    p_title.alignment = WD_ALIGN_PARAGRAPH.LEFT\n    run = p_title.add_run(title)\n    run.font.name = '맑은 고딕'\n    run.font.size = Pt(36)\n    run.font.bold = True\n    run.font.color.rgb = colors['primary']\n    p_title.paragraph_format.space_after = Pt(8)\n    # 부제목\n    if subtitle:\n        p_sub = doc.add_paragraph()\n        p_sub.alignment = WD_ALIGN_PARAGRAPH.LEFT\n        run = p_sub.add_run(subtitle)\n        run.font.name = '맑은 고딕'\n        run.font.size = Pt(18)\n        run.font.color.rgb = colors['text_muted']\n        p_sub.paragraph_format.space_after = Pt(4)\n    # 하단 액센트 바\n    accent_bar = doc.add_paragraph()\n    run = accent_bar.add_run('\\u2588' * 20)\n    run.font.color.rgb = colors['accent']\n    run.font.size = Pt(4)\n    # 저자/날짜\n    for _ in range(4):\n        doc.add_paragraph()\n    if author:\n        p = doc.add_paragraph()\n        run = p.add_run(author)\n        run.font.size = Pt(13)\n        run.font.color.rgb = colors['text_dark']\n    if date_str:\n        p = doc.add_paragraph()\n        run = p.add_run(date_str)\n        run.font.size = Pt(12)\n        run.font.color.rgb = colors['text_muted']\n    doc.add_page_break()\n```\n\n## 프로페셔널 테이블\n```python\ndef add_styled_table(doc, headers, rows, colors=DOC_COLORS):\n    table = doc.add_table(rows=1 + len(rows), cols=len(headers))\n    table.alignment = WD_TABLE_ALIGNMENT.CENTER\n    table.autofit = True\n    # 헤더 행\n    for j, h in enumerate(headers):\n        cell = table.rows[0].cells[j]\n        cell.text = h\n        cell.vertical_alignment = WD_ALIGN_VERTICAL.CENTER\n        shading = parse_xml(f'<w:shd {nsdecls(\"w\")} w:fill=\"{colors[\"table_header\"].hex_string}\"/>')\n        cell.paragraphs[0].runs[0].font.bold = True\n        cell.paragraphs[0].runs[0].font.color.rgb = colors['white']\n        cell.paragraphs[0].runs[0].font.size = Pt(11)\n        cell.paragraphs[0].alignment = WD_ALIGN_PARAGRAPH.CENTER\n        cell._tc.get_or_add_tcPr().append(shading)\n    # 데이터 행 (줄무늬)\n    for i, row_data in enumerate(rows):\n        for j, val in enumerate(row_data):\n            cell = table.rows[i + 1].cells[j]\n            cell.text = str(val)\n            cell.paragraphs[0].runs[0].font.size = Pt(10)\n            cell.paragraphs[0].runs[0].font.color.rgb = colors['text_dark']\n            cell.paragraphs[0].alignment = WD_ALIGN_PARAGRAPH.CENTER\n            if i % 2 == 1:\n                shading = parse_xml(f'<w:shd {nsdecls(\"w\")} w:fill=\"{colors[\"table_alt\"].hex_string}\"/>')\n                cell._tc.get_or_add_tcPr().append(shading)\n    # 테두리\n    tbl = table._tbl\n    tblPr = tbl.tblPr if tbl.tblPr is not None else parse_xml(f'<w:tblPr {nsdecls(\"w\")}/>')\n    borders = parse_xml(\n        f'<w:tblBorders {nsdecls(\"w\")}>'\n        f'<w:top w:val=\"single\" w:sz=\"4\" w:color=\"{colors[\"border\"].hex_string}\"/>'\n        f'<w:left w:val=\"single\" w:sz=\"4\" w:color=\"{colors[\"border\"].hex_string}\"/>'\n        f'<w:bottom w:val=\"single\" w:sz=\"4\" w:color=\"{colors[\"border\"].hex_string}\"/>'\n        f'<w:right w:val=\"single\" w:sz=\"4\" w:color=\"{colors[\"border\"].hex_string}\"/>'\n        f'<w:insideH w:val=\"single\" w:sz=\"4\" w:color=\"{colors[\"border\"].hex_string}\"/>'\n        f'<w:insideV w:val=\"single\" w:sz=\"4\" w:color=\"{colors[\"border\"].hex_string}\"/>'\n        f'</w:tblBorders>'\n    )\n    tblPr.append(borders)\n    return table\n```\n\n## 헤더/푸터 + 페이지 번호\n```python\ndef add_header_footer(doc, header_text='', colors=DOC_COLORS):\n    for section in doc.sections:\n        # 헤더\n        header = section.header\n        header.is_linked_to_previous = False\n        p = header.paragraphs[0]\n        p.alignment = WD_ALIGN_PARAGRAPH.RIGHT\n        run = p.add_run(header_text)\n        run.font.size = Pt(9)\n        run.font.color.rgb = colors['text_muted']\n        run.font.name = '맑은 고딕'\n        # 헤더 하단 보더\n        pPr = p._element.get_or_add_pPr()\n        pBdr = parse_xml(f'<w:pBdr {nsdecls(\"w\")}><w:bottom w:val=\"single\" w:sz=\"4\" w:space=\"4\" w:color=\"{colors[\"border\"].hex_string}\"/></w:pBdr>')\n        pPr.append(pBdr)\n        # 푸터 (페이지 번호)\n        footer = section.footer\n        footer.is_linked_to_previous = False\n        p = footer.paragraphs[0]\n        p.alignment = WD_ALIGN_PARAGRAPH.CENTER\n        run = p.add_run()\n        fld = parse_xml(f'<w:fldSimple {nsdecls(\"w\")} w:instr=\"PAGE\"/>')\n        run._element.append(fld)\n        run.font.size = Pt(9)\n        run.font.color.rgb = colors['text_muted']\n```\n\n## 하이라이트 박스 (인용/주의)\n```python\ndef add_highlight_box(doc, text, box_type='info', colors=DOC_COLORS):\n    color_map = {'info': colors['secondary'], 'warning': colors['accent'], 'note': colors['text_muted']}\n    border_color = color_map.get(box_type, colors['secondary'])\n    p = doc.add_paragraph()\n    p.paragraph_format.space_before = Pt(8)\n    p.paragraph_format.space_after = Pt(8)\n    pPr = p._element.get_or_add_pPr()\n    pBdr = parse_xml(f'<w:pBdr {nsdecls(\"w\")}><w:left w:val=\"single\" w:sz=\"24\" w:space=\"12\" w:color=\"{border_color.hex_string}\"/></w:pBdr>')\n    pPr.append(pBdr)\n    shading = parse_xml(f'<w:shd {nsdecls(\"w\")} w:fill=\"F8F9FA\"/>')\n    pPr.append(shading)\n    run = p.add_run(text)\n    run.font.size = Pt(10)\n    run.font.color.rgb = colors['text_dark']\n    run.font.italic = True\n```\n\n## 전체 조합 예제\n```python\ndoc = Document()\nsetup_styles(doc)\nadd_cover_page(doc, '분기별 성과 보고서', '2025년 1분기', '기획팀', '2025년 4월')\nadd_header_footer(doc, '분기별 성과 보고서 | Confidential')\n\ndoc.add_heading('프로젝트 개요', level=1)\ndoc.add_paragraph('본 문서는 2025년 1분기 프로젝트 성과를 종합적으로 분석합니다.')\nadd_highlight_box(doc, '핵심 KPI: 매출 120% 달성, 신규 고객 500명 확보', 'info')\n\ndoc.add_heading('주요 성과', level=2)\nadd_styled_table(doc,\n    ['항목', '목표', '실적', '달성률'],\n    [['매출', '10억', '12억', '120%'],\n     ['고객수', '400명', '500명', '125%'],\n     ['NPS', '40점', '45점', '113%']]\n)\n\ndoc.add_page_break()\ndoc.add_heading('향후 계획', level=1)\ndoc.add_paragraph('2분기에는 다음 영역에 집중합니다:')\nfor item in ['플랫폼 안정성 강화', '신규 시장 진출', '팀 역량 강화']:\n    p = doc.add_paragraph(item, style='List Bullet')\n\ndoc.save(output_path)\nprint(f'문서가 생성되었습니다: {output_path}')\n```\n\n## DOCX 디자인 체크리스트\n1. **setup_styles() 필수 호출** — 폰트, 색상, 간격 일관성\n2. **커버 페이지** — 전문적 첫인상\n3. **헤더/푸터** — 문서명 + 페이지 번호\n4. **Heading 스타일 사용** — level=1, 2, 3으로 시각적 계층\n5. **프로페셔널 테이블** — 헤더 색상 + 줄무늬\n6. **적절한 여백** — 페이지 상하좌우 2.5cm\n7. **줄간격 1.5** — 가독성 확보"
    },
    {
      "title": "python-pptx를 사용한 프로페셔널 PowerPoint 생성",
      "content": "# python-pptx를 사용한 프로페셔널 PowerPoint 생성\n\n## 설치\n```bash\npip install python-pptx\n```\n\n## 필수 Import 및 초기 설정\n```python\nfrom pptx import Presentation\nfrom pptx.util import Inches, Pt, Emu\nfrom pptx.dml.color import RGBColor\nfrom pptx.enum.text import PP_ALIGN, MSO_ANCHOR\nfrom pptx.enum.shapes import MSO_SHAPE\n\nprs = Presentation()\nprs.slide_width = Inches(13.333)\nprs.slide_height = Inches(7.5)\n```\n\n## 컬러 스킴 정의 (프레젠테이션 전체 일관성)\n```python\n# Corporate Blue 테마 (기본 권장)\nCOLORS = {\n    'primary': RGBColor(0x1B, 0x3A, 0x5C),      # 진한 남색 (헤더 바, 제목 배경)\n    'secondary': RGBColor(0x2E, 0x86, 0xC1),     # 밝은 파랑 (액센트, 강조)\n    'accent': RGBColor(0xE7, 0x4C, 0x3C),        # 레드 (포인트 강조)\n    'bg_light': RGBColor(0xF8, 0xF9, 0xFA),      # 밝은 회색 (슬라이드 배경)\n    'bg_dark': RGBColor(0x1B, 0x3A, 0x5C),       # 어두운 배경 (타이틀 슬라이드)\n    'text_dark': RGBColor(0x2D, 0x2D, 0x2D),     # 어두운 텍스트 (밝은 배경용)\n    'text_light': RGBColor(0xF5, 0xF5, 0xF5),    # 밝은 텍스트 (어두운 배경용)\n    'text_muted': RGBColor(0x7F, 0x8C, 0x8D),    # 보조 텍스트\n    'divider': RGBColor(0xD5, 0xDB, 0xDB),       # 구분선 색상\n    'white': RGBColor(0xFF, 0xFF, 0xFF),          # 흰색\n}\n```\n\n## 핵심 헬퍼 함수\n```python\ndef add_slide_background(slide, prs, color):\n    \"\"\"슬라이드 전체 배경 도형 추가 (항상 맨 먼저 호출)\"\"\"\n    bg = slide.shapes.add_shape(\n        MSO_SHAPE.RECTANGLE, Inches(0), Inches(0),\n        prs.slide_width, prs.slide_height\n    )\n    bg.fill.solid()\n    bg.fill.fore_color.rgb = color\n    bg.line.fill.background()\n    return bg\n\ndef add_text(slide, left, top, width, height, text, font_size=18,\n             bold=False, color=None, alignment=PP_ALIGN.LEFT, font_name=None):\n    \"\"\"텍스트 박스를 추가합니다. color 필수 — 기본값 없이 명시적 지정.\"\"\"\n    txBox = slide.shapes.add_textbox(\n        Inches(left), Inches(top), Inches(width), Inches(height)\n    )\n    tf = txBox.text_frame\n    tf.word_wrap = True\n    p = tf.paragraphs[0]\n    p.text = text\n    p.font.size = Pt(font_size)\n    p.font.bold = bold\n    if color:\n        p.font.color.rgb = color\n    if font_name:\n        p.font.name = font_name\n    p.alignment = alignment\n    return txBox\n\ndef add_accent_bar(slide, left, top, width, height, color):\n    \"\"\"액센트 바 (장식 사각형)\"\"\"\n    bar = slide.shapes.add_shape(\n        MSO_SHAPE.RECTANGLE,\n        Inches(left), Inches(top), Inches(width), Inches(height)\n    )\n    bar.fill.solid()\n    bar.fill.fore_color.rgb = color\n    bar.line.fill.background()\n    return bar\n\ndef add_header_bar(slide, prs, color, height=1.0):\n    \"\"\"슬라이드 상단 헤더 바\"\"\"\n    return add_accent_bar(slide, 0, 0, 13.333, height, color)\n```\n\n## 슬라이드 템플릿 1: 타이틀 슬라이드 (어두운 배경)\n```python\ndef create_title_slide(prs, title, subtitle, colors=COLORS):\n    slide = prs.slides.add_slide(prs.slide_layouts[6])  # Blank\n    # 어두운 배경\n    add_slide_background(slide, prs, colors['bg_dark'])\n    # 액센트 바 (좌측 세로)\n    add_accent_bar(slide, 0, 0, 0.15, 7.5, colors['secondary'])\n    # 하단 액센트 라인\n    add_accent_bar(slide, 0, 6.8, 13.333, 0.08, colors['accent'])\n    # 제목\n    add_text(slide, 1.2, 2.2, 11, 1.5, title,\n             font_size=44, bold=True, color=colors['text_light'],\n             alignment=PP_ALIGN.LEFT)\n    # 부제목\n    add_text(slide, 1.2, 4.0, 9, 0.8, subtitle,\n             font_size=22, color=colors['text_muted'],\n             alignment=PP_ALIGN.LEFT)\n    return slide\n```\n\n## 슬라이드 템플릿 2: 콘텐츠 슬라이드 (헤더 바 + 불릿)\n```python\ndef create_content_slide(prs, title, bullets, colors=COLORS):\n    slide = prs.slides.add_slide(prs.slide_layouts[6])\n    add_slide_background(slide, prs, colors['bg_light'])\n    # 헤더 바\n    add_header_bar(slide, prs, colors['primary'], height=1.1)\n    # 제목 (헤더 바 위)\n    add_text(slide, 0.8, 0.2, 11, 0.7, title,\n             font_size=32, bold=True, color=colors['text_light'],\n             alignment=PP_ALIGN.LEFT)\n    # 불릿 포인트\n    txBox = slide.shapes.add_textbox(\n        Inches(1.0), Inches(1.6), Inches(11), Inches(5.2)\n    )\n    tf = txBox.text_frame\n    tf.word_wrap = True\n    for i, bullet in enumerate(bullets):\n        p = tf.paragraphs[0] if i == 0 else tf.add_paragraph()\n        p.text = f'\\u2022  {bullet}'\n        p.font.size = Pt(18)\n        p.font.color.rgb = colors['text_dark']\n        p.space_after = Pt(12)\n    return slide\n```\n\n## 슬라이드 템플릿 3: 2단 레이아웃\n```python\ndef create_two_column_slide(prs, title, left_items, right_items, colors=COLORS):\n    slide = prs.slides.add_slide(prs.slide_layouts[6])\n    add_slide_background(slide, prs, colors['bg_light'])\n    add_header_bar(slide, prs, colors['primary'], height=1.1)\n    add_text(slide, 0.8, 0.2, 11, 0.7, title,\n             font_size=32, bold=True, color=colors['text_light'])\n    # 좌측 컬럼\n    txL = slide.shapes.add_textbox(Inches(0.8), Inches(1.6), Inches(5.5), Inches(5.0))\n    tf = txL.text_frame\n    tf.word_wrap = True\n    for i, item in enumerate(left_items):\n        p = tf.paragraphs[0] if i == 0 else tf.add_paragraph()\n        p.text = f'\\u2022  {item}'\n        p.font.size = Pt(17)\n        p.font.color.rgb = colors['text_dark']\n        p.space_after = Pt(10)\n    # 세로 구분선\n    add_accent_bar(slide, 6.6, 1.6, 0.03, 4.8, colors['divider'])\n    # 우측 컬럼\n    txR = slide.shapes.add_textbox(Inches(7.0), Inches(1.6), Inches(5.5), Inches(5.0))\n    tf = txR.text_frame\n    tf.word_wrap = True\n    for i, item in enumerate(right_items):\n        p = tf.paragraphs[0] if i == 0 else tf.add_paragraph()\n        p.text = f'\\u2022  {item}'\n        p.font.size = Pt(17)\n        p.font.color.rgb = colors['text_dark']\n        p.space_after = Pt(10)\n    return slide\n```\n\n## 슬라이드 템플릿 4: 섹션 구분 슬라이드\n```python\ndef create_section_slide(prs, section_title, section_number=None, colors=COLORS):\n    slide = prs.slides.add_slide(prs.slide_layouts[6])\n    add_slide_background(slide, prs, colors['secondary'])\n    if section_number:\n        add_text(slide, 1.0, 2.0, 3, 1.0, f'{section_number:02d}',\n                 font_size=72, bold=True, color=colors['white'],\n                 alignment=PP_ALIGN.LEFT)\n    add_text(slide, 1.0, 3.5, 11, 1.0, section_title,\n             font_size=40, bold=True, color=colors['white'],\n             alignment=PP_ALIGN.LEFT)\n    # 하단 장식 라인\n    add_accent_bar(slide, 1.0, 4.8, 4.0, 0.06, colors['white'])\n    return slide\n```\n\n## 슬라이드 템플릿 5: 마무리 슬라이드\n```python\ndef create_closing_slide(prs, title='감사합니다', subtitle='', colors=COLORS):\n    slide = prs.slides.add_slide(prs.slide_layouts[6])\n    add_slide_background(slide, prs, colors['bg_dark'])\n    add_text(slide, 0, 2.5, 13.333, 1.5, title,\n             font_size=48, bold=True, color=colors['text_light'],\n             alignment=PP_ALIGN.CENTER)\n    if subtitle:\n        add_text(slide, 0, 4.2, 13.333, 0.8, subtitle,\n                 font_size=20, color=colors['text_muted'],\n                 alignment=PP_ALIGN.CENTER)\n    # 하단 액센트\n    add_accent_bar(slide, 5.0, 5.5, 3.333, 0.06, colors['secondary'])\n    return slide\n```\n\n## 전체 프레젠테이션 조합 예제\n```python\nprs = Presentation()\nprs.slide_width = Inches(13.333)\nprs.slide_height = Inches(7.5)\n\n# 1. 타이틀\ncreate_title_slide(prs, '프로젝트 진행 보고', '2025년 1분기 성과 및 계획')\n\n# 2. 목차\ncreate_content_slide(prs, '목차', [\n    '프로젝트 개요', '주요 성과', '과제 및 리스크', '다음 분기 계획'\n])\n\n# 3. 섹션 구분\ncreate_section_slide(prs, '프로젝트 개요', section_number=1)\n\n# 4. 콘텐츠\ncreate_content_slide(prs, '프로젝트 개요', [\n    '기간: 2025.01 ~ 2025.03',\n    '목표: 신규 플랫폼 런칭',\n    '팀 규모: 15명 (개발 10, 기획 3, 디자인 2)',\n    '기술 스택: React, Node.js, PostgreSQL',\n])\n\n# 5. 2단 레이아웃\ncreate_two_column_slide(prs, '주요 성과 vs 과제',\n    ['매출 120% 달성', '신규 고객 500명 확보', 'NPS 점수 45점'],\n    ['인력 부족 (2명 충원 필요)', '서버 확장 비용 증가', '경쟁사 신제품 출시']\n)\n\n# 6. 마무리\ncreate_closing_slide(prs, '감사합니다', 'Q&A')\n\noutput_path = '/path/to/output.pptx'\nprs.save(output_path)\nprint(f'프레젠테이션이 생성되었습니다: {output_path}')\n```\n\n## 이미지 삽입\n```python\nslide.shapes.add_picture('image.png', Inches(1), Inches(2), width=Inches(5))\n```\n\n## 표 추가 (디자인 포함)\n```python\ndef add_styled_table(slide, rows_data, left=1.0, top=2.0, width=11.0, colors=COLORS):\n    row_count = len(rows_data)\n    col_count = len(rows_data[0])\n    row_height = 0.5\n    tbl = slide.shapes.add_table(\n        row_count, col_count,\n        Inches(left), Inches(top),\n        Inches(width), Inches(row_height * row_count)\n    ).table\n    # 헤더 행\n    for j, val in enumerate(rows_data[0]):\n        cell = tbl.cell(0, j)\n        cell.text = str(val)\n        cell.fill.solid()\n        cell.fill.fore_color.rgb = colors['primary']\n        for p in cell.text_frame.paragraphs:\n            p.font.size = Pt(14)\n            p.font.bold = True\n            p.font.color.rgb = colors['white']\n            p.alignment = PP_ALIGN.CENTER\n    # 데이터 행\n    for i in range(1, row_count):\n        for j, val in enumerate(rows_data[i]):\n            cell = tbl.cell(i, j)\n            cell.text = str(val)\n            bg = colors['white'] if i % 2 == 1 else colors['bg_light']\n            cell.fill.solid()\n            cell.fill.fore_color.rgb = bg\n            for p in cell.text_frame.paragraphs:\n                p.font.size = Pt(13)\n                p.font.color.rgb = colors['text_dark']\n                p.alignment = PP_ALIGN.CENTER\n    return tbl\n```\n\n## 저장\n```python\nprs.save(output_path)\nprint(f'프레젠테이션이 생성되었습니다: {output_path}')\n```"
    },
    {
      "title": "openpyxl 프로페셔널 Excel 디자인 시스템",
      "content": "# openpyxl 프로페셔널 Excel 디자인 시스템\n\n## 필수 Import\n```python\nfrom openpyxl import Workbook\nfrom openpyxl.styles import Font, PatternFill, Alignment, Border, Side, numbers\nfrom openpyxl.utils import get_column_letter\nfrom openpyxl.chart import BarChart, PieChart, Reference\n```\n\n## 컬러 스킴 정의\n```python\n# Corporate Blue (기본 권장)\nXL_COLORS = {\n    'header_bg': '1B3A5C', 'header_font': 'FFFFFF',\n    'subheader_bg': '2E86C1', 'subheader_font': 'FFFFFF',\n    'accent': 'E74C3C', 'row_alt': 'EBF5FB', 'row_normal': 'FFFFFF',\n    'text_dark': '2D2D2D', 'text_muted': '7F8C8D', 'border': 'D5DBDB',\n    'total_bg': 'F0F4F8', 'positive': '27AE60', 'negative': 'E74C3C',\n}\n```\n\n## 스타일 헬퍼\n```python\ndef xl_styles(colors=XL_COLORS):\n    thin = Side(style='thin', color=colors['border'])\n    return {\n        'header_font': Font(name='맑은 고딕', size=11, bold=True, color=colors['header_font']),\n        'header_fill': PatternFill(start_color=colors['header_bg'], end_color=colors['header_bg'], fill_type='solid'),\n        'data_font': Font(name='맑은 고딕', size=10, color=colors['text_dark']),\n        'title_font': Font(name='맑은 고딕', size=16, bold=True, color=colors['header_bg']),\n        'subtitle_font': Font(name='맑은 고딕', size=11, color=colors['text_muted']),\n        'alt_fill': PatternFill(start_color=colors['row_alt'], end_color=colors['row_alt'], fill_type='solid'),\n        'total_fill': PatternFill(start_color=colors['total_bg'], end_color=colors['total_bg'], fill_type='solid'),\n        'total_font': Font(name='맑은 고딕', size=10, bold=True, color=colors['header_bg']),\n        'positive_font': Font(name='맑은 고딕', size=10, bold=True, color=colors['positive']),\n        'negative_font': Font(name='맑은 고딕', size=10, bold=True, color=colors['negative']),\n        'center': Alignment(horizontal='center', vertical='center'),\n        'left': Alignment(horizontal='left', vertical='center'),\n        'right': Alignment(horizontal='right', vertical='center'),\n        'border': Border(left=thin, right=thin, top=thin, bottom=thin),\n        'num_fmt': '#,##0', 'pct_fmt': '0.0%', 'money_fmt': '#,##0원',\n    }\n```\n\n## 시트 타이틀\n```python\ndef add_sheet_title(ws, title, subtitle='', colors=XL_COLORS):\n    s = xl_styles(colors)\n    ws.merge_cells('A1:H1')\n    ws['A1'] = title\n    ws['A1'].font = s['title_font']\n    ws.row_dimensions[1].height = 35\n    if subtitle:\n        ws.merge_cells('A2:H2')\n        ws['A2'] = subtitle\n        ws['A2'].font = s['subtitle_font']\n    sep_row = 3 if subtitle else 2\n    for col in range(1, 9):\n        ws.cell(row=sep_row, column=col).border = Border(\n            bottom=Side(style='medium', color=colors['header_bg']))\n    ws.row_dimensions[sep_row].height = 6\n    return sep_row + 1\n```\n\n## 프로페셔널 데이터 테이블\n```python\ndef add_data_table(ws, headers, rows, start_row=1, start_col=1, colors=XL_COLORS,\n                   total_row=False, number_cols=None, pct_cols=None):\n    s = xl_styles(colors)\n    number_cols = number_cols or []\n    pct_cols = pct_cols or []\n    for j, h in enumerate(headers):\n        cell = ws.cell(row=start_row, column=start_col + j, value=h)\n        cell.font, cell.fill, cell.alignment, cell.border = s['header_font'], s['header_fill'], s['center'], s['border']\n    ws.row_dimensions[start_row].height = 28\n    for i, row_data in enumerate(rows):\n        for j, val in enumerate(row_data):\n            cell = ws.cell(row=start_row + 1 + i, column=start_col + j, value=val)\n            cell.font, cell.border = s['data_font'], s['border']\n            if i % 2 == 1: cell.fill = s['alt_fill']\n            if (j+1) in number_cols: cell.number_format, cell.alignment = s['num_fmt'], s['right']\n            elif (j+1) in pct_cols: cell.number_format, cell.alignment = s['pct_fmt'], s['center']\n    if total_row and rows:\n        tr = start_row + 1 + len(rows)\n        for j in range(len(headers)):\n            cell = ws.cell(row=tr, column=start_col + j)\n            cell.font, cell.fill, cell.border = s['total_font'], s['total_fill'], s['border']\n            if j == 0: cell.value = '합계'\n            elif (j+1) in number_cols:\n                cl = get_column_letter(start_col + j)\n                cell.value = f'=SUM({cl}{start_row+1}:{cl}{start_row+len(rows)})'\n                cell.number_format = s['num_fmt']\n    # 열 너비 자동\n    for j, h in enumerate(headers):\n        max_len = max(len(str(h)), *(len(str(r[j])) for r in rows if j < len(r)))\n        ws.column_dimensions[get_column_letter(start_col + j)].width = min(max_len + 4, 40)\n    return start_row + 1 + len(rows) + (1 if total_row else 0)\n```\n\n## 전체 조합 예제\n```python\nwb = Workbook()\nws = wb.active\nws.title = '매출 리포트'\ndata_start = add_sheet_title(ws, '월간 매출 리포트', '2025년 3월 | 기획팀')\nheaders = ['지역', '매출', '목표', '달성률']\nrows = [['서울', 450000000, 400000000, 1.125], ['부산', 280000000, 300000000, 0.933]]\nadd_data_table(ws, headers, rows, start_row=data_start, number_cols=[2,3], pct_cols=[4], total_row=True)\nws.freeze_panes = f'A{data_start+1}'\nwb.save(output_path)\n```\n\n## XLSX 디자인 체크리스트\n1. xl_styles() 일관 컬러 2. 시트 타이틀 3. 헤더 색상+볼드 4. 줄무늬 5. 합계 행\n6. 숫자 포맷 7. 열 너비 자동 8. 틀 고정 9. 조건부 색상 10. 차트 컬러 통일"
    },
    {
      "title": "문서 생성 공통 워크플로우",
      "content": "# 문서 생성 공통 워크플로우\n\n## 핵심 원칙\n1. file_write 도구로 바이너리(.docx, .pptx, .xlsx) 파일을 직접 생성하지 마세요\n2. 반드시 Python 스크립트를 작성한 후 **즉시** command_execute로 실행합니다\n3. 출력 경로는 사용자의 작업 디렉토리(workingDirectory) 기준으로 설정합니다\n4. **사용자에게 수동 설치를 절대 요청하지 마세요** — 모든 것을 자동화합니다\n5. **반드시 SEPilot 전용 venv를 사용합니다** — 글로벌 Python에 직접 pip install하지 마세요\n\n## 표준 워크플로우\n\n### Step 1: Python 스크립트 작성 (venv 내 의존성 자동 설치)\nfile_write 도구로 Python 스크립트(.py)를 작성합니다. **반드시 스크립트 상단에 venv 기반 의존성 설치 코드를 포함**합니다:\n```python\nimport subprocess, os\n\n# SEPilot venv 경로\nVENV = os.path.expanduser('~/.sepilot/environments/python')\nBIN = 'Scripts' if os.name == 'nt' else 'bin'\n     VENV_PIP = os.path.join(VENV, BIN, 'pip')\n\n# 의존성 자동 설치 (venv pip 사용, 이미 설치된 경우 빠르게 건너뜀)\nsubprocess.check_call([VENV_PIP, 'install', '-q', 'python-pptx'])\n\nfrom pptx import Presentation\nfrom pptx.util import Inches, Pt\n# ... 문서 생성 로직 ...\nprint(f'문서가 생성되었습니다: {output_path}')\n```\n\n### Step 2: venv를 통해 스크립트 즉시 실행\ncommand_execute 도구로 **즉시** 실행합니다 (venv 원샷 패턴):\n```bash\nVENV=\"$HOME/.sepilot/environments/python\" && \\\n(test -f \"$VENV/bin/python\" || python3 -m venv \"$VENV\") && \\\n\"$VENV/bin/pip\" install -q python-pptx && \\\n\"$VENV/bin/python\" /path/to/create_document.py\n```\n\n### Step 3: 결과 확인 및 안내\n생성된 파일 경로를 사용자에게 안내합니다.\n\n## 라이브러리별 자동 설치 패턴 (venv)\n\n### Word (python-docx)\n```python\nimport subprocess, os\nVENV_PIP = os.path.join(os.path.expanduser('~/.sepilot/environments/python'), 'bin', 'pip')\nsubprocess.check_call([VENV_PIP, 'install', '-q', 'python-docx'])\nfrom docx import Document\n```\n\n### PowerPoint (python-pptx)\n```python\nimport subprocess, os\nVENV_PIP = os.path.join(os.path.expanduser('~/.sepilot/environments/python'), 'bin', 'pip')\nsubprocess.check_call([VENV_PIP, 'install', '-q', 'python-pptx'])\nfrom pptx import Presentation\n```\n\n### Excel (openpyxl)\n```python\nimport subprocess, os\nVENV_PIP = os.path.join(os.path.expanduser('~/.sepilot/environments/python'), 'bin', 'pip')\nsubprocess.check_call([VENV_PIP, 'install', '-q', 'openpyxl'])\nfrom openpyxl import Workbook\n```\n\n### Excel + pandas\n```python\nimport subprocess, os\nVENV_PIP = os.path.join(os.path.expanduser('~/.sepilot/environments/python'), 'bin', 'pip')\nsubprocess.check_call([VENV_PIP, 'install', '-q', 'pandas', 'openpyxl'])\nimport pandas as pd\n```\n\n## 금지 사항 (절대 하지 마세요)\n- ❌ 사용자에게 `pip install` 수동 실행을 요청하는 것\n- ❌ 스크립트를 작성만 하고 실행하지 않는 것\n- ❌ 패키지가 미설치되어 있다는 이유로 작업을 중단하는 것\n- ❌ file_write로 바이너리(.docx, .pptx, .xlsx) 파일을 직접 생성하는 것\n- ❌ 글로벌 Python/pip에 직접 패키지를 설치하는 것\n\n## 주의사항\n- venv pip은 이미 설치된 패키지에 대해 빠르게 건너뜁니다 (-q 옵션으로 출력도 최소화)\n- venv 경로(`~/.sepilot/environments/python`)의 절대 경로를 사용하세요\n- 한글 폰트 사용 시 시스템에 설치된 폰트를 확인하세요 (맑은 고딕, 나눔고딕 등)\n- 이미지 삽입 시 이미지 파일이 존재하는지 먼저 확인하세요\n- 대용량 데이터는 CSV/JSON에서 읽어와서 처리하세요\n\n## 에러 처리 템플릿\n```python\nimport subprocess, os, sys\n\nVENV = os.path.expanduser('~/.sepilot/environments/python')\nBIN = 'Scripts' if os.name == 'nt' else 'bin'\n     VENV_PIP = os.path.join(VENV, BIN, 'pip')\nVENV_PYTHON = os.path.join(VENV, 'bin', 'python')\n\n# venv 생성 (없을 때만)\nif not os.path.isfile(VENV_PYTHON):\n    try:\n        subprocess.check_call([sys.executable, '-m', 'venv', VENV])\n    except subprocess.CalledProcessError:\n        subprocess.check_call(['python3', '-m', 'venv', VENV])\n\n# 의존성 자동 설치\nsubprocess.check_call([VENV_PIP, 'install', '-q', 'python-pptx'])\n\ntry:\n    # 문서 생성 로직\n    print(f'성공: {output_path}')\nexcept Exception as e:\n    print(f'문서 생성 실패: {e}', file=sys.stderr)\n    sys.exit(1)\n```"
    },
    {
      "title": "PPTX 프로페셔널 디자인 시스템",
      "content": "# PPTX 프로페셔널 디자인 시스템\n\n## 5가지 컬러 스킴\n\n### 1. Corporate Blue (기본)\n```python\nCOLORS_CORPORATE = {\n    'primary': RGBColor(0x1B, 0x3A, 0x5C),\n    'secondary': RGBColor(0x2E, 0x86, 0xC1),\n    'accent': RGBColor(0xE7, 0x4C, 0x3C),\n    'bg_light': RGBColor(0xF8, 0xF9, 0xFA),\n    'bg_dark': RGBColor(0x1B, 0x3A, 0x5C),\n    'text_dark': RGBColor(0x2D, 0x2D, 0x2D),\n    'text_light': RGBColor(0xF5, 0xF5, 0xF5),\n    'text_muted': RGBColor(0x7F, 0x8C, 0x8D),\n    'divider': RGBColor(0xD5, 0xDB, 0xDB),\n    'white': RGBColor(0xFF, 0xFF, 0xFF),\n}\n```\n\n### 2. Modern Dark\n```python\nCOLORS_DARK = {\n    'primary': RGBColor(0x1E, 0x1E, 0x2E),\n    'secondary': RGBColor(0x6C, 0x5C, 0xE7),\n    'accent': RGBColor(0x00, 0xCE, 0xC9),\n    'bg_light': RGBColor(0x2D, 0x2D, 0x3F),\n    'bg_dark': RGBColor(0x14, 0x14, 0x22),\n    'text_dark': RGBColor(0xEC, 0xEC, 0xEC),\n    'text_light': RGBColor(0xF5, 0xF5, 0xF5),\n    'text_muted': RGBColor(0xA0, 0xA0, 0xB0),\n    'divider': RGBColor(0x44, 0x44, 0x55),\n    'white': RGBColor(0xFF, 0xFF, 0xFF),\n}\n```\n\n### 3. Nature Green\n```python\nCOLORS_GREEN = {\n    'primary': RGBColor(0x1E, 0x8A, 0x49),\n    'secondary': RGBColor(0x27, 0xAE, 0x60),\n    'accent': RGBColor(0xF3, 0x9C, 0x12),\n    'bg_light': RGBColor(0xF5, 0xF9, 0xF5),\n    'bg_dark': RGBColor(0x14, 0x55, 0x2E),\n    'text_dark': RGBColor(0x2C, 0x3E, 0x2C),\n    'text_light': RGBColor(0xF0, 0xF8, 0xF0),\n    'text_muted': RGBColor(0x7D, 0x8C, 0x7D),\n    'divider': RGBColor(0xC8, 0xE0, 0xC8),\n    'white': RGBColor(0xFF, 0xFF, 0xFF),\n}\n```\n\n### 4. Warm Professional\n```python\nCOLORS_WARM = {\n    'primary': RGBColor(0x8B, 0x4D, 0x1A),\n    'secondary': RGBColor(0xD4, 0x7B, 0x2A),\n    'accent': RGBColor(0xC0, 0x39, 0x2B),\n    'bg_light': RGBColor(0xFD, 0xF8, 0xF0),\n    'bg_dark': RGBColor(0x5D, 0x33, 0x10),\n    'text_dark': RGBColor(0x3C, 0x2A, 0x1A),\n    'text_light': RGBColor(0xFA, 0xF0, 0xE0),\n    'text_muted': RGBColor(0x9C, 0x88, 0x70),\n    'divider': RGBColor(0xE0, 0xD0, 0xC0),\n    'white': RGBColor(0xFF, 0xFF, 0xFF),\n}\n```\n\n### 5. Elegant Gray\n```python\nCOLORS_GRAY = {\n    'primary': RGBColor(0x34, 0x34, 0x34),\n    'secondary': RGBColor(0x5D, 0x5D, 0x5D),\n    'accent': RGBColor(0xC0, 0x39, 0x2B),\n    'bg_light': RGBColor(0xFA, 0xFA, 0xFA),\n    'bg_dark': RGBColor(0x2C, 0x2C, 0x2C),\n    'text_dark': RGBColor(0x33, 0x33, 0x33),\n    'text_light': RGBColor(0xF0, 0xF0, 0xF0),\n    'text_muted': RGBColor(0x88, 0x88, 0x88),\n    'divider': RGBColor(0xDD, 0xDD, 0xDD),\n    'white': RGBColor(0xFF, 0xFF, 0xFF),\n}\n```\n\n## KPI/지표 카드 패턴\n```python\ndef add_kpi_card(slide, left, top, width, height, label, value, colors):\n    \"\"\"KPI 카드: 라벨 + 큰 숫자\"\"\"\n    # 카드 배경\n    card = slide.shapes.add_shape(\n        MSO_SHAPE.ROUNDED_RECTANGLE,\n        Inches(left), Inches(top), Inches(width), Inches(height)\n    )\n    card.fill.solid()\n    card.fill.fore_color.rgb = colors['white']\n    card.line.color.rgb = colors['divider']\n    card.line.width = Pt(1)\n    # 상단 액센트 바\n    accent = slide.shapes.add_shape(\n        MSO_SHAPE.RECTANGLE,\n        Inches(left), Inches(top), Inches(width), Inches(0.06)\n    )\n    accent.fill.solid()\n    accent.fill.fore_color.rgb = colors['secondary']\n    accent.line.fill.background()\n    # 라벨\n    add_text(slide, left + 0.2, top + 0.3, width - 0.4, 0.4, label,\n             font_size=13, color=colors['text_muted'])\n    # 값\n    add_text(slide, left + 0.2, top + 0.7, width - 0.4, 0.6, value,\n             font_size=36, bold=True, color=colors['primary'])\n\n# 사용 예: KPI 대시보드 슬라이드\nslide = prs.slides.add_slide(prs.slide_layouts[6])\nadd_slide_background(slide, prs, COLORS['bg_light'])\nadd_header_bar(slide, prs, COLORS['primary'])\nadd_text(slide, 0.8, 0.2, 11, 0.7, '핵심 지표',\n         font_size=32, bold=True, color=COLORS['text_light'])\nadd_kpi_card(slide, 0.8, 1.6, 3.6, 1.6, '월간 매출', '₩12.5억', COLORS)\nadd_kpi_card(slide, 4.8, 1.6, 3.6, 1.6, '신규 고객', '1,234명', COLORS)\nadd_kpi_card(slide, 8.8, 1.6, 3.6, 1.6, 'NPS 점수', '67점', COLORS)\n```\n\n## 테이블 디자인 (헤더 색상 + 줄무늬)\n```python\ndef add_styled_table(slide, data, left=1.0, top=2.2, width=11.0, colors=COLORS):\n    rows, cols = len(data), len(data[0])\n    tbl = slide.shapes.add_table(\n        rows, cols, Inches(left), Inches(top),\n        Inches(width), Inches(0.45 * rows)\n    ).table\n    for j, val in enumerate(data[0]):\n        cell = tbl.cell(0, j)\n        cell.text = str(val)\n        cell.fill.solid()\n        cell.fill.fore_color.rgb = colors['primary']\n        for p in cell.text_frame.paragraphs:\n            p.font.size = Pt(14)\n            p.font.bold = True\n            p.font.color.rgb = colors['white']\n            p.alignment = PP_ALIGN.CENTER\n    for i in range(1, rows):\n        for j, val in enumerate(data[i]):\n            cell = tbl.cell(i, j)\n            cell.text = str(val)\n            bg = colors['white'] if i % 2 == 1 else RGBColor(0xEB, 0xF5, 0xFB)\n            cell.fill.solid()\n            cell.fill.fore_color.rgb = bg\n            for p in cell.text_frame.paragraphs:\n                p.font.size = Pt(13)\n                p.font.color.rgb = colors['text_dark']\n    return tbl\n```\n\n## 프레젠테이션 마무리 체크리스트\n\n모든 PPTX 생성 후 반드시 확인:\n1. **모든 텍스트에 font.color.rgb 명시** — 기본값 사용 금지\n2. **모든 슬라이드에 배경색 설정** — add_slide_background() 또는 slide.background\n3. **일관된 컬러 스킴** — COLORS dict 하나로 통일\n4. **폰트 크기 계층** — 제목 40-48pt > 소제목 28-32pt > 본문 16-18pt > 캡션 12-14pt\n5. **16:9 비율 확인** — Inches(13.333) x Inches(7.5)\n6. **도형 line 제거** — 장식 도형은 shape.line.fill.background()\n7. **텍스트 대비 확인** — 밝은 배경→어두운 텍스트, 어두운 배경→밝은 텍스트"
    }
  ]
}
